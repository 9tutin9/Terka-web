<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Preview e-mailov√Ωch ≈°ablon - Dƒõti dƒõtem</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #f5f5f5; }
        .preview-container { max-width: 1200px; margin: 0 auto; }
        .preview-section { background: white; margin: 20px 0; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .preview-title { color: #333; border-bottom: 2px solid #007bff; padding-bottom: 10px; }
        .email-frame { border: 1px solid #ddd; border-radius: 8px; overflow: hidden; }
        .email-header { background: #007bff; color: white; padding: 10px; font-weight: bold; }
        .email-content { height: 600px; overflow-y: auto; }
        .tabs { display: flex; margin-bottom: 20px; }
        .tab { padding: 10px 20px; background: #e9ecef; border: 1px solid #ddd; cursor: pointer; margin-right: 5px; }
        .tab.active { background: #007bff; color: white; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
    </style>
</head>
<body>
    <div class="preview-container">
        <h1>üìß Preview e-mailov√Ωch ≈°ablon</h1>
        
        <div class="tabs">
            <div class="tab active" onclick="showTab('customer')">Z√°kaznick√Ω e-mail</div>
            <div class="tab" onclick="showTab('admin')">Admin e-mail</div>
        </div>

        <div id="customer" class="tab-content active">
            <div class="preview-section">
                <h2 class="preview-title">Z√°kaznick√Ω e-mail - Potvrzen√≠ objedn√°vky</h2>
                <div class="email-frame">
                    <div class="email-header">üìß Z√°kaznick√Ω e-mail</div>
                    <div class="email-content" id="customer-email"></div>
                </div>
            </div>
        </div>

        <div id="admin" class="tab-content">
            <div class="preview-section">
                <h2 class="preview-title">Admin e-mail - Nov√° objedn√°vka</h2>
                <div class="email-frame">
                    <div class="email-header">üìß Admin e-mail</div>
                    <div class="email-content" id="admin-email"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Test data
        const testData = {
            order_number: "20250109001",
            amount: 207,
            vs: "7193501961",
            customer_name: "Marie Svobodov√°",
            customer_email: "marie.svobodova@email.cz",
            customer_phone: "+420 777 123 456",
            address_line: "Hlavn√≠ 268",
            address_city: "Doln√≠ ≈Ωivotice",
            address_zip: "74756",
            payment_message: "Dƒõkuji za kr√°sn√Ω n√°ramek!",
            delivery_note: "Pros√≠m doruƒçit do 15:00",
            qr_png: "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2ZmZiIvPjx0ZXh0IHg9IjEwMCIgeT0iMTAwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTQiPk1vY2t1cCBRUiBjb2RlPC90ZXh0Pjwvc3ZnPg==",
            items: [
                { name: "N√°ramek l√°sky", qty: 2, price: 69, size: "M" },
                { name: "N√°ramek nadƒõje", qty: 1, price: 69, size: "L" }
            ]
        };

        // Email helper functions
        function generateItemsHTML(items) {
            if (!items || !Array.isArray(items)) return '<p>≈Ω√°dn√© polo≈æky</p>';
            
            return items.map(item => `
                <div style="display: flex; align-items: center; padding: 10px; border-bottom: 1px solid #eee;">
                    <div style="flex: 1;">
                        <strong>${item.name || 'N√°ramek'}</strong>
                        ${item.size ? `<br><small>Velikost: ${item.size}</small>` : ''}
                    </div>
                    <div style="text-align: right;">
                        <div>${item.qty}x</div>
                        <div><strong>${(item.price || 69).toLocaleString('cs-CZ')} Kƒç</strong></div>
                    </div>
                </div>
            `).join('');
        }

        function generateCustomerEmail(data) {
            const itemsHTML = generateItemsHTML(data.items);
            const currentDate = new Date().toLocaleDateString('cs-CZ');
            
            // V√Ωpoƒçet dopadu na dƒõti v Jemenu
            const costPerMealCZK = 23;
            const meals = Math.max(1, Math.floor((Number(data.amount) || 0) / costPerMealCZK));
            const impactMeals = meals;
            const unit = impactMeals === 1 ? 'j√≠dlo' : (impactMeals < 5 ? 'j√≠dla' : 'j√≠del');
            const impactLine = `Odhadovan√Ω dopad: ${impactMeals} ${unit} (p≈ôi ${costPerMealCZK} Kƒç/j√≠dlo).`;
            
            return `
                <!DOCTYPE html>
                <html lang="cs">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Potvrzen√≠ objedn√°vky - Dƒõti dƒõtem</title>
                    <style>
                        body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px; }
                        .header { text-align: center; background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
                        .logo { max-width: 200px; height: auto; }
                        .order-info { background: #e3f2fd; padding: 15px; border-radius: 8px; margin: 20px 0; }
                        .items { background: #f5f5f5; padding: 15px; border-radius: 8px; margin: 20px 0; }
                        .qr-section { text-align: center; margin: 20px 0; }
                        .qr-code { max-width: 200px; height: auto; }
                        .footer { text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee; color: #666; }
                        .highlight { background: #fff3cd; padding: 10px; border-radius: 5px; margin: 15px 0; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <img src="https://www.detidetem.eu/images/detidetem.logo.webp" alt="Dƒõti dƒõtem" class="logo">
                        <h1>Dƒõkujeme za va≈°i objedn√°vku!</h1>
                    </div>

                    <div class="order-info">
                        <h2>üìã Detaily objedn√°vky</h2>
                        <p><strong>ƒå√≠slo objedn√°vky:</strong> ${data.order_number}</p>
                        <p><strong>ƒå√°stka:</strong> ${data.amount} Kƒç</p>
                        <p><strong>Variabiln√≠ symbol:</strong> ${data.vs}</p>
                        <p><strong>Datum:</strong> ${currentDate}</p>
                    </div>

                    <div class="items">
                        <h3>üõçÔ∏è Objednan√© polo≈æky</h3>
                        ${itemsHTML}
                    </div>

                    <div class="qr-section">
                        <h3>üí≥ QR platba</h3>
                        <p>Naskenujte QR k√≥d mobiln√≠ aplikac√≠ va≈°√≠ banky:</p>
                        <img src="${data.qr_png}" alt="QR k√≥d pro platbu" class="qr-code">
                        <p><strong>Variabiln√≠ symbol:</strong> ${data.vs}</p>
                        <p><strong>ƒå√°stka:</strong> ${data.amount} Kƒç</p>
                    </div>

                    <div class="highlight">
                        <h3>üåç V√°≈° dopad</h3>
                        <p><strong>${impactLine}</strong></p>
                        <p>Ka≈æd√Ω n√°kup n√°ramku pom√°h√° dƒõtem v Jemenu. Dƒõkujeme, d√≠ky t√©to objedn√°vce p≈ôisp√≠v√°te na j√≠dlo pro dƒõti v nouzi.</p>
                    </div>

                    <div class="highlight">
                        <h3>üìö D≈Øle≈æit√© upozornƒõn√≠</h3>
                        <p>Jeliko≈æ jsme ≈°kolou povinn√≠, doruƒçen√≠ va≈°eho n√°ramku se m≈Ø≈æe trochu zpozdit. Dƒõkujeme za trpƒõlivost!</p>
                    </div>

                    <div class="footer">
                        <p>Dƒõti dƒõtem - Ka≈æd√Ω n√°ramek pom√°h√° dƒõtem v nouzi</p>
                        <p>Web: <a href="https://www.detidetem.eu">www.detidetem.eu</a></p>
                    </div>
                </body>
                </html>
            `;
        }

        function generateAdminEmail(data) {
            const itemsHTML = generateItemsHTML(data.items);
            const currentDate = new Date().toLocaleDateString('cs-CZ');
            
            return `
                <!DOCTYPE html>
                <html lang="cs">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Nov√° objedn√°vka - Dƒõti dƒõtem</title>
                    <style>
                        body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px; }
                        .header { text-align: center; background: #dc3545; color: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
                        .logo { max-width: 200px; height: auto; }
                        .order-info { background: #e3f2fd; padding: 15px; border-radius: 8px; margin: 20px 0; }
                        .customer-info { background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 20px 0; }
                        .items { background: #f5f5f5; padding: 15px; border-radius: 8px; margin: 20px 0; }
                        .footer { text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee; color: #666; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <img src="https://www.detidetem.eu/images/detidetem.logo.webp" alt="Dƒõti dƒõtem" class="logo">
                        <h1>üö® Nov√° objedn√°vka #${data.order_number}</h1>
                    </div>

                    <div class="order-info">
                        <h2>üìã Detaily objedn√°vky</h2>
                        <p><strong>ƒå√≠slo objedn√°vky:</strong> ${data.order_number}</p>
                        <p><strong>ƒå√°stka:</strong> ${data.amount} Kƒç</p>
                        <p><strong>Variabiln√≠ symbol:</strong> ${data.vs}</p>
                        <p><strong>Datum:</strong> ${currentDate}</p>
                    </div>

                    <div class="customer-info">
                        <h3>üë§ Z√°kazn√≠k</h3>
                        <p><strong>Jm√©no:</strong> ${data.customer_name}</p>
                        <p><strong>E-mail:</strong> ${data.customer_email}</p>
                        <p><strong>Telefon:</strong> ${data.customer_phone}</p>
                        <p><strong>Adresa:</strong> ${data.address_line}, ${data.address_city} ${data.address_zip}</p>
                        ${data.payment_message ? `<p><strong>Zpr√°va pro p≈ô√≠jemce:</strong> ${data.payment_message}</p>` : ''}
                        ${data.delivery_note ? `<p><strong>Pozn√°mka k dod√°n√≠:</strong> ${data.delivery_note}</p>` : ''}
                    </div>

                    <div class="items">
                        <h3>üõçÔ∏è Objednan√© polo≈æky</h3>
                        ${itemsHTML}
                    </div>

                    <div class="footer">
                        <p>Dƒõti dƒõtem - Admin panel</p>
                        <p>Web: <a href="https://www.detidetem.eu/admin.html">www.detidetem.eu/admin.html</a></p>
                    </div>
                </body>
                </html>
            `;
        }

        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Generate and display emails
        document.getElementById('customer-email').innerHTML = generateCustomerEmail(testData);
        document.getElementById('admin-email').innerHTML = generateAdminEmail(testData);
    </script>
</body>
</html>
